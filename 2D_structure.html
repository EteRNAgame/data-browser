<head>
  <title>EteRNA - Played by Humans. Scored by Nature.</title>
  <script>

  // returns a zero-parameter closure with seq bound
  function putSequence( seq ) {
    // Delay setting sequence until flash app is ready
    return function () {
      var applet = document.getElementById('maingame');
      if (!applet || !applet.set_sequence_string) {
        setTimeout( putSequence ( seq ), 200 );
        return;
      }
      applet.set_sequence_string(seq);
      console.log( "Sequence " + seq + " set" );
    }
  }

  // parse parameters
  var options = {}
  location.search.replace(/\?/,"").toLowerCase().split("&").map( function(x){ 
    var temp = x.split("="); if (temp.length >= 2) 
    options[temp[0].trim()] = temp[1].trim(); 
  });

  //window.addEventListener("load", function(event) {
  document.addEventListener("DOMContentLoaded", function(event) {
    console.log("DOM fully loaded and parsed; Puzzlequery string is " + location.search.substr(1));
    document.body.outerHTML = 
    '<body style="padding:0px; margin:0px">  <embed id="maingame" src="http://staging.eternagame.org/eterna_resources/Eterna123.swf" width="100%" height="100%" type="application/x-shockwave-flash" cache="true" bgcolor="#061A34" flashvars="inputtype=PUZZLE&inputval='
      + options.puzzleid
      + '&username=&uid=0&databrowser=true&q=index.php" allowscriptaccess="always">';  
    putSequence( options.sequence )();
  });
  </script>
</head>
<!--
    <body style="padding:0px; margin:0px"> 
      <embed id="maingame" src="/eterna_resources/Eterna123.swf" width="100%" height="100%" type="application/x-shockwave-flash" cache="true" bgcolor="#061A34" flashvars="inputtype=PUZZLE&inputval=3398937&username=&uid=0&databrowser=true&q=index.php" allowscriptaccess="always">  
-->    
</body>

